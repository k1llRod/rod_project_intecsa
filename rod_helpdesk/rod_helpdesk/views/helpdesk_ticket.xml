<!-- views/helpdesk_ticket_form.xml -->
<odoo>
    <record id="view_helpdesk_ticket_form_inherit_accessories" model="ir.ui.view">
        <field name="name">helpdesk.ticket.form.inherit.accessories</field>
        <field name="model">helpdesk.ticket</field>
        <field name="inherit_id" ref="helpdesk.helpdesk_ticket_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[1]" position="after">
                <group>
                    <field name="accessory_line_ids">
                        <tree editable="bottom" string="Lista de accesorios">
                            <field name="accesory_description" string="DescripciÃ³n"/>
                            <field name="quantity" string="Cantidad" widget="float"/>
                            <field name="notes" string="Observaciones" widget="text"/>
                            <field name="state" string="Estado"/>
                        </tree>
                    </field>
                </group>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="attributes">
                <attribute name="string">Tipo de equipo</attribute>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                <field name="marca"/>
                <field name="modelo"/>
                <field name="serial_number"/>
            </xpath>
            <xpath expr="//div[@class='oe_button_box']" position="inside">
                <button type="action"
                        name="%(action_helpdesk_ticket_sale_orders)d"
                        string="Ventas"
                        icon="fa-shopping-cart"
                        class="oe_stat_button"
                        modifiers='{"invisible": [["sale_order_ids", "=", false]]}'>
                    <field name="sale_order_ids" widget="statinfo"/>
                </button>
            </xpath>
        </field>
    </record>
    <record id="action_helpdesk_ticket_sale_orders" model="ir.actions.act_window">
        <field name="name">Ventas Relacionadas</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('ticket_id', '=', active_id)]</field>
        <field name="context">{}</field>
    </record>
    <record id="view_order_tree_inherit_helpdesk" model="ir.ui.view">
        <field name="name">sale.order.tree.inherit.helpdesk</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="inside">
                <field name="ticket_id"/>
            </xpath>
        </field>
    </record>

</odoo>
